<!DOCTYPE html>
<html>

<head>
    <title>Live stream</title>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width">
    <script type="text/javascript">
    	function changeLang() {
    		if (navigator.language=="zh-CN") {
    			document.getElementById("btCamera").innerHTML="我要直播"
                document.getElementById('str_q').innerHTML='画质'
    		}
    	}
        function livestream() {
            var q=document.getElementById('quality').value
            location.href=location.href.replace('live','camera')+"?q="+q
        }
    	setTimeout("changeLang()", 50)
    </script>
</head>

<body>
	<u><a style="cursor: pointer;color: blue;" onclick="livestream()" id="btCamera">Live stream</a></u>
    <span id="str_q"> Quality:</span>
    <select id="quality">
        <option value="1.0" selected>1.0</option>
        <option value="0.8">0.8</option>
        <option value="0.6">0.6</option>
        <option value="0.4">0.4</option>
        <option value="0.2">0.2</option>
        <option value="0.1">0.1</option>
    </select>
    <br>
    <img src="" id="receiver" alt="online(0)">
    <script type="text/javascript">
    var image = document.getElementById("receiver")
    var domain = location.href.split("/")[2]
    var socket = new WebSocket("ws://" + domain + "/wsLive")
    socket.onmessage = function(e) {
        var mData = JSON.parse(e.data)
        if (mData.Mtype == "video") {
            image.src = mData.Data
        }
    }
    socket.onopen = function(e) {
        console.log('connected')
    }
    socket.onclose = function(e) {
        console.log('closed')
    }
    </script>
</body>

</html>